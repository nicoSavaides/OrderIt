<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* Ensure the body takes up the full viewport height */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Lora", sans-serif;
      text-align: center;
      background-color: #e9ece6;
      color: #000000;
      display: flex;
      flex-direction: column;
      justify-content: space-between; /* Align content top-to-bottom */
      padding: 20px;
      box-sizing: border-box;
    }

    #welcomeScreen h1 {
      font-size: 4rem;
      font-weight: bold;
      line-height: .3;
    }

    #welcomeScreen p {
      font-size: 1.5rem;
      margin-top: 10px;
      line-height: 1.5;
    }

    #gameScreen h2 {
      font-size: 3rem;  /* Adjust this value as needed */
    }

    .hidden {
      display: none;
    }

    button {
      font-size: 1.2rem;
      background-color: #000000;
      color: #FFFFFF;
      padding: 10px 20px;
      margin-top: 150px;
      cursor: pointer;
      border-radius: 40px;
    }

    #itemList {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 150px;
      padding: 0;
      list-style: none;
    }

    @font-face {
      font-family: 'Milk And Honey';
      src: url('orderItFont.ttf') format('truetype');
    }

    h1, h2, h3 {
      font-family: 'Milk And Honey', sans-serif;
    }

    @font-face {
      font-family: 'Lora';
      src: url('Lora.ttf') format('truetype');
    }

    p {
      font-family: 'Lora', sans-serif;
    }

    .draggable-item {
      padding: 10px;
      margin: 5px;
      background-color: #CCCCCC;
      border: 1px solid #ccc;
      cursor: grab;
      font-weight: 900;
      width: 300px;
      max-width: 400px;
      box-sizing: border-box;
      text-align: center;
    }

    .drag-over {
      border: 2px dashed #333;
    }

    #gameStatus {
      position: absolute;
      top: 20%; /* Adjust this to move it up/down */
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      color: #000000;
      font-family: 'Milk And Honey', sans-serif;
      text-align: center;
    }

    /* Date at the bottom */
    #currentDate {
      font-size: 1rem;
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
    }

    #endScreen p {
      font-size: 1.5rem;
      margin-top: 150px;
    }











    /* Mobile-specific styles */
    @media (max-width: 768px) {
      /* Increase font sizes for mobile */
      body {
        font-size: 18px; /* Larger font size for body text */
      }

      h1 {
        font-size: 7rem; /* Larger header size */
      }

      h2 {
        font-size: 4rem; /* Larger h2 for game screen */
      }

      button {
        font-size: 2rem; /* Larger buttons */
        padding: 15px 30px;
      }

      .draggable-item {
        font-size: 3rem; /* Larger draggable items */
        width: 80%; /* Larger width for draggable elements */
      }

      #itemList {
        padding: 0;
        list-style: none;
        width: 100%;
        margin-top: 50px;
      }

      .mobile-logo {
        width: 400px; /* Larger size for mobile */
        height: 200px; /* Larger size for mobile */
      }
    }
















    @media (max-width: 480px) {
      /* Further adjustments for smaller screens (smartphones) */
      h1 {
        font-size: 3rem !important; 
      }

      h2 {
        font-size: 2rem !important;
      }


      p {
        padding-top: 50px !important;
        font-size: 1.2rem !important;
       }

       

      button {
        font-size: 1.5rem;
        padding: 12px 25px;
        margin-top: 20px;
      }


      #currentDate {
      font-size: 0.8rem !important;
      position: relative; /* Now moves with the rest of the content */
      padding-top: 50px !important;
      padding: 10px;
    }
     
     

     

      .draggable-item {
        font-size: 2rem; /* Larger draggable items */
        width: 90%;
      }

      #strikeCount {
        font-size: 1.5rem; /* Adjust strike count font size */
      }

      /* Item list adjustments */
      #itemList {
        width: 100%;
        margin-top: 30px;
      }
    }

    /* General styles for the gif */
    .mobile-logo {
      width: 200px; /* Default size */
      height: 100px; /* Default size */
    }
















  </style>
</head>
<body>
  <!-- Your body content here -->
</body>


  <div id="welcomeScreen">
    <div>

      <img src="movingLogo.gif" alt="Moving Logo" class="mobile-logo">



      <h1>Order It.</h1>
      <p>Drag the items into the correct order based on the given category. The item with the lowest value (smallest, shortest, lightest, etc.) should go at the top. 
        The item with the highest value (largest, tallest, heaviest, etc.) should go at the bottom. 3 rounds. 3 mistakes allowed.</p>
      <button onclick="startGame()">Play</button>
    </div>
  </div>

  <div id="gameScreen" class="hidden">
    <h2 id="roundPrompt">Order by:</h2>
    
    <p id="gameStatus"></p>
    

    <ul id="itemList"></ul>
    <p id="strikeCount">Strikes: 0/3</p>
    <button onclick="submitOrder()">Submit</button>
  </div>

  <div id="endScreen" class="hidden">
    <p>Thanks for playing. Come back tomorrow for a new challenge.</p>
    <p id="finalScore"></p> <!-- their score will appear here -->
    <button id="shareButton">Share your score</button> <!-- share button -->
    <p id="shareLink" style="word-break: break-all;"></p> <!-- link will show up here -->
  </div>
  
  <p id="currentDate"></p>

  <script>
    let currentRound = 0;
    let rounds = [];
    let strikes = 0;
    const maxStrikes = 3;

    function startGame() {
      document.getElementById('welcomeScreen').classList.add('hidden');
      document.getElementById('gameScreen').classList.remove('hidden');

      fetch("rounds.json")
        .then(res => res.json())
        .then(data => {
          rounds = data.days[0];
          loadRound();
        });
    }

    function displayCurrentDate() {
      const now = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      const formattedDate = now.toLocaleDateString(undefined, options);
      document.getElementById('currentDate').textContent = `${formattedDate}`;
    }

    displayCurrentDate();

    function loadRound() {
  if (currentRound >= rounds.length) {
    endGame();
    return;
  }

  const { prompt, items } = rounds[currentRound];
  document.getElementById('roundPrompt').textContent = "Order by: " + prompt;

  const itemList = document.getElementById('itemList');

  // Only create the list once (on the first round)
  if (currentRound === 0) {
    items.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item;
      li.setAttribute('draggable', true);
      li.classList.add('draggable-item');
      itemList.appendChild(li);
    });
  }

  updateStrikes();
  makeItemsDraggable();
}


    function makeItemsDraggable() {
      const items = document.querySelectorAll('.draggable-item');
      let draggedItem = null;

      items.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          draggedItem = item;
        });

        item.addEventListener('dragover', (e) => {
          e.preventDefault();
          item.classList.add('drag-over');
        });

        item.addEventListener('dragleave', () => {
          item.classList.remove('drag-over');
        });

        item.addEventListener('drop', () => {
          item.classList.remove('drag-over');
          if (draggedItem !== item) {
            const list = item.parentNode;
            const draggedIndex = Array.from(list.children).indexOf(draggedItem);
            const droppedIndex = Array.from(list.children).indexOf(item);

            if (draggedIndex < droppedIndex) {
              list.insertBefore(draggedItem, item.nextSibling);
            } else {
              list.insertBefore(draggedItem, item);
            }
          }
        });
      });
    }

    function submitOrder() {
      const itemList = document.getElementById('itemList');
      const submittedOrder = Array.from(itemList.children).map(li => li.textContent);
      const correctOrder = rounds[currentRound].correctOrder;

      if (JSON.stringify(submittedOrder) === JSON.stringify(correctOrder)) {
        currentRound++;
        if (currentRound < rounds.length) {
          loadRound();
        } else {
          document.getElementById('gameStatus').textContent = "Nice!";
        }
      } else {
        strikes++;
        document.getElementById('strikeCount').textContent = `Strikes: ${strikes}/${maxStrikes}`;

        if (strikes >= maxStrikes) {
          document.getElementById('gameStatus').textContent = "Game Over";

          // ✅ Clear the current list
          itemList.innerHTML = '';

          // ✅ Show a label
          const label = document.createElement('p');
          label.textContent = 'Correct Order:';
          label.style.fontWeight = 'bold';
          label.style.position = 'relative';
          label.style.top = '150px'; // or however many pixels you want
          label.style.marginBottom = '0px'; // to avoid extra spacing

          label.style.fontSize = '1.2rem';
          itemList.parentNode.insertBefore(label, itemList);

          // ✅ Populate correct order
          correctOrder.forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            li.classList.add('draggable-item');
            li.style.backgroundColor = '#555555'; // Light green for visibility
            li.style.fontWeight = 'bold';
            li.style.cursor = 'default';
            li.setAttribute('draggable', false); // prevent dragging
            itemList.appendChild(li);
          });

          // ✅ Disable the submit button
          document.querySelector("button[onclick='submitOrder()']").disabled = true;

          // ✅ Transition to end screen after 5 seconds
          setTimeout(() => {
            label.remove();
            endGame();
          }, 5000);
        }
      }
    }

    function updateStrikes() {
      document.getElementById('strikeCount').textContent = `Strikes: ${strikes}/${maxStrikes}`;
    }

    let score = 0; // you should already be tracking this

function endGame() {
  document.getElementById('gameScreen').classList.add('hidden');
  document.getElementById('endScreen').classList.remove('hidden');

  // Show their final score
  document.getElementById('finalScore').textContent = `You scored ${score} out of 3!`;

  // Set up the share button
  const shareButton = document.getElementById('shareButton');
  shareButton.onclick = function() {
    generateShareLink();
  };
}

function generateShareLink() {
  // Create a simple shareable link with score in the URL
  const baseUrl = window.location.origin + window.location.pathname; // current page
  const shareUrl = `${baseUrl}?score=${score}`;

  const shareLink = document.getElementById('shareLink');
  shareLink.innerHTML = `<a href="${shareUrl}" target="_blank">${shareUrl}</a>`;

  // Optionally, automatically copy to clipboard:
  navigator.clipboard.writeText(shareUrl).then(() => {
    alert('Link copied to clipboard!');
  });
}

// If you want, you can ALSO read the ?score= part of URL and display it when someone clicks a shared link!
window.onload = function() {
  const urlParams = new URLSearchParams(window.location.search);
  const sharedScore = urlParams.get('score');
  if (sharedScore !== null) {
    alert(`Your friend's score: ${sharedScore}/3`);
  }
};


    const date = new Date().toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
    document.getElementById('currentDate').textContent = date;
  </script>

</body>
</html>
